<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ููููุฏ ุงูุทูุจ ุงูุฎุทู ุงูุฌุฒุงุฆุฑู</title>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">

    <!-- Libraries -->
    <script src="libs/html2pdf.bundle.min.js"></script>
    <script src="libs/html-docx.js"></script>
    <script src="libs/FileSaver.min.js"></script>

    <!-- External CSS -->
    <link rel="stylesheet" href="style.css">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#006633">
    <link rel="apple-touch-icon" href="icon.png">

    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./sw.js')
                    .then(registration => {
                        console.log('ServiceWorker registration successful');
                    })
                    .catch(err => {
                        console.log('ServiceWorker registration failed: ', err);
                    });
            });
        }
    </script>

<body>

    <div class="app-container">
        <!-- Form Section -->
        <div class="form-section">
            <div class="form-header">
                <h1>ููููุฏ ุงูุทูุจ ุงูุฎุทู</h1>
                <p style="font-size: 0.8rem; color: #666;">ุฃุฏุฎู ูุนูููุงุชู ูุฅูุดุงุก ุงูุทูุจ ุชููุงุฆูุงู</p>
            </div>

            <div class="form-group">
                <label>ุญุฌู ุงูุฎุท</label>
                <input type="range" id="fontSize" min="14" max="20" value="16" step="1">
                <div style="text-align: center; font-size: 0.8rem;" id="fontSizeVal">16pt</div>
            </div>

            <div class="form-group">
                <label>ุงูุงุณู ูุงูููุจ</label>
                <input type="text" id="inputName" placeholder="ูุซุงู: ูุญูุฏ ุฃุญูุฏ">
            </div>

            <div class="form-group">
                <label>ุงูุนููุงู ุงููุงูู</label>
                <input type="text" id="inputAddress" placeholder="ูุซุงู: ุญู ุงูุฒููุฑุ ุงูุฌุฒุงุฆุฑ ุงููุณุทู">
            </div>

            <div class="form-group">
                <label>ุฑูู ุงููุงุชู</label>
                <input type="tel" id="inputPhone" placeholder="0661 00 00 00">
            </div>

            <div class="form-group">
                <label>ุงูุชุงุฑูุฎ</label>
                <input type="date" id="inputDate">
            </div>

            <div class="form-group">
                <label>ุฅูู ุงูุณูุฏ ูุฏูุฑ</label>
                <input type="text" id="inputDirector" placeholder="ูุซุงู: ุงูููุงุฑุฏ ุงูุจุดุฑูุฉ">
            </div>

            <div class="form-group">
                <label>ุงูููุถูุน</label>
                <input type="text" id="inputSubject" placeholder="ูุซุงู: ุทูุจ ุชูุธูู">
            </div>

            <div class="form-group">
                <label>ูุญุชูู ุงูุทูุจ</label>
                <textarea id="inputContent" placeholder="ุฃูุชุจ ูุต ุงูุทูุจ ููุง..."></textarea>
            </div>

            <div class="actions">
                <button class="btn btn-primary" onclick="printRequest()">
                    <span>๐จ๏ธ ุทุจุงุนุฉ</span>
                </button>
                <button class="btn btn-secondary" onclick="downloadPDF()">
                    <span>๐ ุชุญููู PDF</span>
                </button>
                <button class="btn btn-outline" onclick="downloadDOCX()">
                    <span>๐ ุชุญููู DOCX</span>
                </button>
            </div>
        </div>

        <!-- Preview Section -->
        <div class="preview-section">
            <div id="request-page">
                <!-- Header: Sender & Date -->
                <div class="page-header">
                    <div class="sender-info">
                        <div>ุงูุงุณู ูุงูููุจ: <span id="outName">................</span></div>
                        <div>ุงูุนููุงู: <span id="outAddress">................</span></div>
                        <div>ุฑูู ุงููุงุชู: <span id="outPhone">................</span></div>
                    </div>
                    <div class="date-info">
                        <span id="outDate">..../../..</span>
                    </div>
                </div>

                <!-- Recipient -->
                <div class="recipient-section">
                    ุฅูู ุงูุณูุฏ ูุฏูุฑ: <span id="outDirector">................</span>
                </div>

                <!-- Subject -->
                <div class="subject-section">
                    ุงูููุถูุน: <span id="outSubject">................</span>
                </div>

                <!-- Content -->
                <div class="content-section" id="outContent">
                    ูู ุนุธูู ุงูุดุฑู ุฃู ุฃุชูุฏู ุฅูู ุณูุงุฏุชูู ุงููุญุชุฑูุฉ ุจูุฐุง ุงูุทูุจ...
                </div>

                <!-- Signature -->
                <div class="signature-section">
                    <div>ุงูุฅูุถุงุก:</div>
                    <div style="margin-top: 10px; font-style: italic;" id="outSignature"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- External JS -->
    <script src="script.js"></script>
</body>

</html>